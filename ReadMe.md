# CPSC 471 Final Project

This directory contains all of the code that is used for the final project for CPSC471. In this project, I aim to set a new standard for model security, fairness, and explainability in sensitive environments such as insurance and criminal justice with a 3-step framework for augmenting current implementations:

1) Node Explainability: Using custom loss functions along with concept-based reasoning and training, I can guarantee that certain nodes in the machine learning model represent certain concepts that, when mapped with the corresponding output of the model, can shed light into why certain decisions are made in the model. Contrary to before where models were considered black-boxes, the integration of this idea-based semantic reasoning into the later layers of the model takes the idea of [TCAV](https://arxiv.org/abs/1711.11279) to the extreme. Instead of training a linear classifier to try to find instances which might represent a certain concept, the most salient concepts to the output are defined by the training pipeline and utilized to explain the output. 

2) Feature Importance Limiting: By incorporating a series of tests to understand how different nodes and features in a machine learning model interact with one another, I am able to adjust the weights in the models that I generate so that harmful or banned inputs to the model are not utilized. Instead, other weights feeding into that node with inputs are greedily selected and up- or down-weighted to attempt to mimic the action of the original node. This efficiently places the model into the state it would converge to anyways without the banned input – where the banned input is roughly approximated and backed out in the model – in substantially less time than before while removing the harmful variance that the banned feature brings (that which cannot be approximated with high fidelity).

3) Weight Freezing with Fidelity: Using a hashing mechanism with model encryption, we can guarantee that when the machine learning model has been trained and deployed by a trusted entity that signs it with their key and keeps track of the model hash, any attempts to change or re-train the model will result in the hash changing thereby showing to everyone that the weights have changed. By introducing this hashing mechanism, the model can be deployed remotely while decreasing the computation power that is required to verify that the model is safe from an entire evaluation of the model using something like min-perturbation and counterfactual analyses to a simple hash and API call to a central, trusted authority. One can think of this as the signing authority for machine learning models. 


Within this repository, we have the following directories that have the following funcitons:

| Folder Name | Purpose |
| ------------- | ------ |
| models | This folder contains all of the code that is needed to run the program itself. Within it, one can find files such as `health_insrurance_base_models.ipynb` which forms the core of this repository along with the private and public example keys for model encryption and decryption. If one uses any of thise code for development or personal use, please make sure to generate these keys again to mitigate against security leaks. |
| models_save | This contains all of the checkpoints for models that we have created in the process of creating this entire repository. It has all of the models that have been saved and kept across the runthroughs of the notebook and is valuable for analysis of model performance overtime. |
| runthroughs | This contains all of the full runs that we have performed of the most important notebooks of this directory. There is an included description for each of the folders in the readme within the sub-directory of runthroughs. |
| references | This contains the consulted and cited sources that are used to create this project. |

It is important to note that running the training process and explanation processes is extremely time- and computation-intensive, so please be wary of where the note books are run and respectful of resources. 